<!-- VISITOR COUNTER (Clean & Neutral Style) -->
<div style="display:flex; gap:12px; margin-top:1.5rem; flex-wrap:wrap; font-family:sans-serif;">

    <!-- Page Visits -->
    <div style="background:#f3f4f6; color:#1f2937; padding:8px 16px; border-radius:24px; font-weight:600; display:flex; align-items:center; gap:8px; box-shadow:0 2px 6px rgba(0,0,0,0.05);" title="Number of visitors to this page">
        <span>üìÑ</span>
        <span>Page Visits:</span>
        <span id="page-visit-count">0</span>
    </div>

    <!-- Total Visits -->
    <div style="background:#f3f4f6; color:#1f2937; padding:8px 16px; border-radius:24px; font-weight:600; display:flex; align-items:center; gap:8px; box-shadow:0 2px 6px rgba(0,0,0,0.05);" title="Total visitors across all pages">
        <span>üåê</span>
        <span>Total Visits:</span>
        <span id="total-visit-count">0</span>
    </div>

</div>

<script>
    const pageSlug = "{{ page.url | slugify | default: 'home' }}";
    const site = "sujeetkumar7.github.io";

    const pageApiUrl = `https://visitor-counter.netlify.app/api/count?site=${site}&page=${pageSlug}`;
    const totalApiUrl = `https://visitor-counter.netlify.app/api/count?site=${site}&page=total`;

    function animateCount(element, target) {
      let count = 0;
      const step = Math.ceil(target / 50);
      const interval = setInterval(() => {
        count += step;
        if (count >= target) {
          count = target;
          clearInterval(interval);
        }
        element.innerText = count;
      }, 20);
    }

    async function fetchCount(url, elementId, fallback) {
      try {
        const res = await fetch(url);
        if (!res.ok) throw new Error('API error');
        const data = await res.json();
        animateCount(document.getElementById(elementId), data.count || fallback);
      } catch(err) {
        console.warn('VisitorCounter error or local preview:', err);
        // Show fallback value in local preview
        document.getElementById(elementId).innerText = fallback;
      }
    }

    // Set fallback counts for local preview
    const fallbackPageCount = 123;
    const fallbackTotalCount = 456;

    fetchCount(pageApiUrl, 'page-visit-count', fallbackPageCount);
    fetchCount(totalApiUrl, 'total-visit-count', fallbackTotalCount);
</script>
